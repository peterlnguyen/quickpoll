// Generated by CoffeeScript 1.6.3
(function() {
  $(document).ready(function() {
    var append_choice, bind_append, bind_next, current_choice, current_id, extract_fields, has_duplicates, has_errors;
    current_choice = 5;
    current_id = "#choice5";
    bind_append(current_id);
    bind_append = function(identifier) {
      $("" + identifier).unbind();
      return $("" + identifier).keyup(function() {
        return bind_next();
      });
    };
    bind_next = function() {
      current_choice++;
      current_id = "#choice" + current_choice;
      append_choice();
      return bind_append(current_id);
    };
    append_choice = function() {
      return $("#choice-list").append(' \
      <div> \
        <label> Choice ' + current_choice + ':</label> \
        <input type="text" name="choices" id="' + current_id + '" class="choices"> \
      </div> \
    ');
    };
    extract_fields = function(form) {
      var values;
      values = {};
      form.each(function() {
        return values[this.name] = $(this).val();
      });
      return values;
    };
    has_errors = function(inputs) {
      var error_flag, key, value, _i, _len;
      error_flag = false;
      for (key = _i = 0, _len = inputs.length; _i < _len; key = ++_i) {
        value = inputs[key];
        if (value === "") {
          error_flag = true;
        }
      }
      return error_flag;
    };
    $("#pollSubmit").click(function() {
      var inputs;
      inputs = extract_fields($("#pollForm :input"));
      if (has_errors(inputs)) {
        return console.log("input errors!");
      } else if (has_duplicates(".choices")) {
        return console.log("duplicate errors!");
      } else {
        console.log("no errors!");
        return $("#pollForm").submit();
      }
    });
    return has_duplicates = function(identifier) {
      var choices, duplicate_flag;
      choices = {};
      duplicate_flag = false;
      $("" + identifier).each(function() {
        var value;
        value = $(this).val();
        if (choices[value]) {
          return duplicate_flag = true;
        } else {
          return choices[value] = "foobar";
        }
      });
      return duplicate_flag;
    };
  });

}).call(this);
